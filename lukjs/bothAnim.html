<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>

<!-- ================== ANIMATION 1 (instance mode) ================== -->
<script>
const anim1 = (p) => {

  let capture;
  let pixelSize = 8;
  let cols, rows;
  let gammaZ = 0.5;
  let t = 0;

  let BASE_ORANGE;
  let codeLines = [];
  let codeLineHeight;
  let currentLine = 0;
  let currentChar = 0;
  let charsPerSecond = 14;
  let charAccumulator = 0;
  let codeMarginLeft = 40;
  let codeMarginBottom = 40;
  let typingFinished = false;

  p.setup = function () {
    let parent = document.getElementById("canvasWrap");
    let w = parent.clientWidth;
    let h = parent.clientHeight;

    let c = p.createCanvas(w, h);
    c.parent("canvasWrap");

    p.frameRate(60);
    p.colorMode(p.RGBA, 255, 0);

    BASE_ORANGE = p.color('#f95d2d');

    cols = p.floor(p.width / pixelSize);
    rows = p.floor(p.height / pixelSize);

    capture = p.createCapture(p.VIDEO);
    capture.size(cols, rows);
    capture.hide();

    p.noStroke();
    p.textFont("monospace");
    p.textSize(18);
    p.textAlign(p.LEFT, p.TOP);
    codeLineHeight = p.textAscent() + p.textDescent() + 4;

    initCodeLines();
  };

  p.draw = function () {
    drawSoftDarkBackgroundZ();
    drawZordonWall();
  };

  function drawZordonWall() {
    capture.loadPixels();
    if (!capture.pixels || capture.pixels.length === 0) return;

    let cellW = p.width / cols;
    let cellH = p.height / rows;

    let orBase = p.red(BASE_ORANGE);
    let ogBase = p.green(BASE_ORANGE);
    let obBase = p.blue(BASE_ORANGE);

    for (let y = 0; y < rows; y++) {
      for (let x = 0; x < cols; x++) {

        let sx = capture.width - x - 1;
        let sy = y;
        let index = (sx + sy * capture.width) * 4;

        let r = capture.pixels[index];
        let g = capture.pixels[index + 1];
        let b = capture.pixels[index + 2];

        let rawBright = (r + g + b) / 3;
        let bright = 255 * p.pow((rawBright / 255), gammaZ);

        let z = p.map(bright, 0, 255, 3, 0);
        let sizeMult = p.map(bright, 0, 255, 0.5, 1.6);

        let cellX = x * cellW;
        let cellY = y * cellH;

        let jitterX = p.map(p.noise(x * 0.1, y * 0.1, t * 0.01), 0, 1, -z * 2, z * 2);
        let jitterY = p.map(p.noise(x * 0.1 + 100, y * 0.1 + 100, t * 0.01), 0, 1, -z * 2, z * 2);

        let cx = cellX + cellW * 0.5 + jitterX;
        let cy = cellY + cellH * 0.5 + jitterY;

        let d = p.dist(cx, cy, p.mouseX, p.mouseY);
        if (d < 150) {
          let force = (150 - d) / 150;
          let ang = p.atan2(cy - p.mouseY, cx - p.mouseX);
          cx += p.cos(ang) * force * 28;
          cy += p.sin(ang) * force * 28;
        }

        let colR, colG, colB;
        let whiteAccent = bright > 160;

        if (whiteAccent) {
          let tCol = p.map(bright, 160, 255, 0.4, 1.0);
          tCol = p.constrain(tCol, 0.4, 1.0);
          colR = p.lerp(orBase, 255, tCol);
          colG = p.lerp(ogBase, 255, tCol);
          colB = p.lerp(obBase, 255, tCol);
        } else {
          let tCol = p.map(bright, 0, 160, 0.2, 1.0);
          tCol = p.constrain(tCol, 0.2, 1.0);
          colR = p.lerp(0, orBase, tCol);
          colG = p.lerp(0, ogBase, tCol * 0.9);
          colB = p.lerp(0, obBase, tCol * 0.8);
        }

        let alphaVal = p.map(bright, 0, 255, 50, 255);
        alphaVal = p.constrain(alphaVal, 40, 255);

        p.fill(0, 0, 0, alphaVal * 0.6);
        p.rect(cx + 4, cy + 4, cellW * sizeMult, cellH * sizeMult, 2);

        p.fill(colR, colG, colB, alphaVal);
        p.rect(cx, cy, cellW * sizeMult, cellH * sizeMult, 2);
      }
    }

    t += 1;
  }

  function drawSoftDarkBackgroundZ() {
    p.clear();
  }

  function initCodeLines() {
    codeLines = ["// example"];
  }
};

new p5(anim1);
</script>




<!-- ================== ANIMATION 2 (instance mode, unchanged) ================== -->
<script>
const anim2 = (p) => {

  let particles = [];

  p.setup = function () {
    let canvas = p.createCanvas(p.windowWidth, p.windowHeight);
    canvas.parent("canvas-container");

    p.colorMode(p.HSB, 360, 100, 100, 100);

    for (let i = 0; i < 150; i++) {
      particles.push(new Particle());
    }
  };

  p.draw = function () {
    p.background(14, 82, 98);

    for (let part of particles) {
      part.update();
      part.show();
    }

    for (let i = 0; i < particles.length; i++) {
      for (let j = i + 1; j < particles.length; j++) {
        let d = p.dist(particles[i].pos.x, particles[i].pos.y, particles[j].pos.x, particles[j].pos.y);

        if (d < 130) {
          p.stroke(0, 0, 130, p.map(d, 0, 130, 100, 0));
          p.strokeWeight(1.2);
          p.line(particles[i].pos.x, particles[i].pos.y, particles[j].pos.x, particles[j].pos.y);
        }
      }
    }
  };

  class Particle {
    constructor() {
      this.pos = p.createVector(p.random(p.width), p.random(p.height));
      this.vel = p5.Vector.random2D().mult(p.random(0.5, 1.5));
      this.size = p.random(2, 4);
    }

    update() {
      let mouse = p.createVector(p.mouseX, p.mouseY);
      let dir = p5.Vector.sub(mouse, this.pos);
      let d = dir.mag();

      if (d < 100) {
        dir.setMag(0.5);
        this.vel.add(dir);
        this.vel.limit(3);
      }

      this.pos.add(this.vel);
      this.edges();
    }

    show() {
      p.noStroke();
      p.fill(0, 0, 100, 50);
      p.ellipse(this.pos.x, this.pos.y, this.size);
    }

    edges() {
      if (this.pos.x < 0) this.pos.x = p.width;
      if (this.pos.x > p.width) this.pos.x = 0;
      if (this.pos.y < 0) this.pos.y = p.height;
      if (this.pos.y > p.height) this.pos.y = 0;
    }
  }
};

new p5(anim2);
</script>




<!-- ================== TWO DIVS ================== -->
<!-- <div id="canvasWrap" style="position:absolute; top:0; left:0; width:50%; height:100%;"></div>
<div id="canvas-container" style="position:absolute; top:0; right:0; width:50%; height:100%;"></div> -->

</body>
</html>